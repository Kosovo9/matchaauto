FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
COPY package-lock.json* ./

RUN npm ci --legacy-peer-deps --ignore-scripts

COPY . .

EXPOSE 8000

# We use --ip 0.0.0.0 to ensure it's accessible outside the container
CMD ["npx", "wrangler", "dev", "src/index.ts", "--ip", "0.0.0.0", "--port", "8000"]
